{% set active_page = 'tasks' %}
{% extends 'base.html' %}

{% block head %}

{% endblock %}

{% block body %}

<div class="container">
    <br>
    <div class="row p-2">
        <form action="/api/task/add" method="POST" id="newtask" class="pb-2">
            <div class="row g-3">
                <div class="col-sm-7">
                    <label for="content" class="form-label">Task</label>
                    <input type="text" id="content" class="form-control" name="content">
                </div>
                <div class="col-sm">
                    <label class="form-label" for="tag">Tag</label>
                    <select class="form-select" id="tag" name="tag">
                        <option></option>
                        {% for tag in tags %}
                        <option value="{{ tag.content }}">{{ tag.content }}</option>
                        {% endfor %}
                    </select>
                </div>
                <div class="col-auto align-items-end">
                    <button type="button" class="btn btn-primary" name="newtag"><i
                            class="fa-solid fa-plus"></i></button>
                </div>
                <div class="col-sm">
                    <label class="form-label" for="datepicker">Due Date</label>
                    <input type="text" id="datepicker" name="datepicker" class="date form-control" readonly="readonly"
                        placeholder="MM/DD/YYYY" value="">
                </div>
                <div class="col-auto align-self-end ">
                    <button type="submit" name="submit" class="btn btn-primary">Add Task</button>
                </div>
            </div>
        </form>
    </div>

    <div class="row pt-5">

        {% if tasks|length < 1 %} <h2>There are no Tasks.</h2>
            {% else %}
            <table id="tasksTable" class="table table-striped table-bordered" style="width:100%">
                <thead>
                    <tr>
                        <th scope="col" style="white-space: nowrap; width: 1%;">Tag</th>
                        <th scope="col">Task</th>
                        <th scope="col">Added</th>
                        <th scope="col">Due</th>
                        <th scope="col"></th>

                    </tr>
                </thead>
                <tbody>
                    {% for task in tasks %}
                    <tr>
                        <th scope="row" style="white-space: nowrap; width: 1%;">{{ task.tag }}</th>
                        <td>{{ task.content }}</td>
                        <td>{{ task.date_created }}</td>
                        <td>{{ task.date_due }}</td>
                        <td style="white-space: nowrap; width: 1%;">
                            <a href="/api/task/delete/{{task.id}}"><i class="fa-solid fa-trash-can"></i></a>
                            <a href="/api/task/update/{{task.id}}"><i class="fa-solid fa-pen-to-square"></i></a>
                        </td>
                    </tr>
                    {% endfor %}
                </tbody>
            </table>
            {% endif %}
    </div>

    <script>
        $(document).ready(function () {
            $('#tasksTable').DataTable();
        });
    </script>


</div>

{% endblock body %}